(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,r){e.exports=r(40)},33:function(e,t,r){},40:function(e,t,r){"use strict";r.r(t);var n=r(0),c=r.n(n),a=r(14),s=r.n(a),i=r(2),o=r(3),l=r(6),u=r(4),d=r(7),p=r(5),m=(r(33),function(){return{type:"FETCH_PRODUCTS_START"}}),y=function(e){return{type:"FETCH_PRODUCTS_SUCCESS",payload:{products:e}}},h=function(e){return{type:"FETCH_PRODUCTS_FAILURE",payload:{error:e}}};function f(e){if(!e.ok)throw Error(e.statusText);return e}var E=r(8),_=r(9),g=r(22),v=r.n(g),S=function(e){function t(e){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("button",{className:this.props.type,onClick:this.props.click&&function(){e.props.click(e.props.headerType)},disabled:this.props.totalSelected<2||this.props.totalPrice<=0},"surgery"===this.props.type||"discount"===this.props.type?c.a.createElement(E.a,{icon:_.b}):""," ",this.props.text)}}]),t}(n.Component),b=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e)))._getHeaderItems=function(e){r.props._handleGetHeaderItems(e)},r.state={date:v()().format("YYYY.MM.DD HH:mm")},r}return Object(d.a)(t,e),Object(o.a)(t,[{key:"_renderHeaderType",value:function(e){var t=this;switch(e){case"main":return c.a.createElement("div",{className:"header__wrapper cb_clear"},c.a.createElement("div",{className:"userName"},this.props.userName),c.a.createElement("div",{className:"date"},this.state.date),c.a.createElement(S,{type:"surgery",text:"\uc81c\ud488",click:this._getHeaderItems,headerType:"surgery"}),c.a.createElement(S,{type:"discount",text:"\ud560\uc778",click:this._getHeaderItems,headerType:"discount"}));case"surgery":case"discount":return c.a.createElement("div",{className:"header__wrapper cb_clear br-b-n"},c.a.createElement("i",{onClick:function(){t._getHeaderItems("main")},className:"ico"},c.a.createElement(E.a,{icon:_.d}))," ",c.a.createElement("h2",null,"surgery"===e?"\uc81c\ud488\uba54\ub274":"\ud560\uc778"));default:return c.a.createElement("div",{className:"header__wrapper cb_clear"},c.a.createElement("div",{className:"userName"},this.props.userName),c.a.createElement("div",{className:"date"},this.state.date),c.a.createElement(S,{type:"surgery",text:"\uc81c\ud488",click:this._getHeaderItems,headerType:"surgery"}),c.a.createElement(S,{type:"discount",text:"\ud560\uc778",click:this._getHeaderItems,headerType:"discount"}))}}},{key:"render",value:function(){return c.a.createElement("header",null,this._renderHeaderType(this.props.headerType))}}]),t}(n.Component),O=Object(p.b)(function(e){var t={};for(var r in e.interfaceReducer)e.interfaceReducer.hasOwnProperty(r)&&(t[r]=e.interfaceReducer[r]);return t},function(e){return{_handleGetHeaderItems:function(t){e(function(e){return{type:"HEADER_TYPE",headerType:e}}(t))}}})(b),N=r(19),k=(r(38),function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e)))._applyDiscount=function(e){var t=document.getElementById("discountTarget").value;if(r.props.selectedDiscount.filter(function(e){return e.target===t}).length)return alert("\uc774\ubbf8 \ud560\uc778 \uc801\uc6a9\ub41c \uc0c1\ud488\uc785\ub2c8\ub2e4.");r.props._handleApplyDiscount(e.i,t),e.onClose()},r._deleteSelectedDiscount=function(e){r.props._handleDeleteSelectedDiscount(e.i),e.onClose()},r}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this._fetchProducts()}},{key:"_fetchProducts",value:function(){this.props._handleFetchProducts()}},{key:"_selectAction",value:function(e,t){this.props._handleSelectAction(e,t)}},{key:"_modifyCount",value:function(e,t){var r=t.target.value;this.props._handleModifyCount(e,r)}},{key:"_removeSelectedSurgery",value:function(e){var t=this;Object(N.confirmAlert)({title:"\uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",message:"",closeOnEscape:!0,closeOnClickOutside:!0,buttons:[{label:"YES",onClick:function(){return t.props._handleRemoveSelectedSurgery(e)}},{label:"NO"}]})}},{key:"_modifySelectedDiscount",value:function(e,t){var r=this;Object(N.confirmAlert)({closeOnEscape:!0,closeOnClickOutside:!0,customUI:function(n){var a=n.onClose;return c.a.createElement("section",{className:"discount__targetList"},c.a.createElement("h2",null,e.name),c.a.createElement("input",{id:"discountTarget",defaultValue:e.target,placeholder:"\uac80\uc0c9",list:"discountTargetSurgeries"}),c.a.createElement("datalist",{id:"discountTargetSurgeries"},r.props.selectedSurgery.map(function(e,t){if(!1===e.isDiscount)return c.a.createElement("option",{key:t,value:e.name},e.price)})),c.a.createElement("div",null,c.a.createElement(S,{type:"surgery p-h-3",text:"\uc0ad\uc81c",headerType:{onClose:a,i:t},click:r._deleteSelectedDiscount}),c.a.createElement(S,{type:"discount p-h-3",text:"\uc801\uc6a9",headerType:{onClose:a,i:t},click:r._applyDiscount})))}})}},{key:"_makeList",value:function(){var e=this,t=[];if(this.props.selectedSurgery.length){var r=this.props.selectedSurgery.map(function(t,r){var n=t.price.toLocaleString(e.props.currency,{minimumFractionDigits:0}),a=t.discountPrice&&t.discountPrice.toLocaleString(e.props.currency,{minimumFractionDigits:0});return c.a.createElement("section",{className:"cursor-none",key:r},c.a.createElement("div",{className:"items__wrapper cb_clear"},c.a.createElement("div",{className:"name"},c.a.createElement("h2",null,t.name)),c.a.createElement("span",{className:a&&"strike"},n,"\uc6d0"),a&&c.a.createElement("span",{className:"discountPrice"},a,"\uc6d0 (",t.discountName," \uc774\ubca4\ud2b8 \uc801\uc6a9)"),c.a.createElement("div",{className:"items__wrapper__surgery--buttons cb_clear"},c.a.createElement("select",{onChange:function(t){e._modifyCount(r,t)},value:t.count},function(e){for(var t=[],r=1;r<=e;r++)t.push(c.a.createElement("option",{key:r,value:r},r));return t}(t.totalCount)),c.a.createElement("button",{className:"delete-surgery",onClick:function(){e._removeSelectedSurgery(r)}},"\uc0ad\uc81c"))))});t.push(r)}if(this.props.selectedDiscount.length){var n=this.props.selectedDiscount.map(function(t,r){var n=Number(100*t.rate).toFixed();return c.a.createElement("section",{className:"cursor-none",key:r},c.a.createElement("div",{className:"items__wrapper cb_clear"},c.a.createElement("div",{className:"name"},c.a.createElement("h2",null,t.name)),c.a.createElement("span",{className:"discountPercent"},n,"% \ud560\uc778"),c.a.createElement("div",{className:"items__wrapper__surgery--buttons cb_clear"},c.a.createElement("button",{className:"modify-discount",onClick:function(){e._modifySelectedDiscount(t,r)}},"\uc870\ud68c \ubc0f \uc801\uc6a9"))))});t.push(n)}return t.length||(t=c.a.createElement("section",{className:"noItems cursor-none"},"\uc81c\ud488\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")),t}},{key:"_renderProducts",value:function(e){var t=this,r=this.props.products;switch(e){case"main":return this._makeList();case"surgery":if(Object.keys(r).length){var n=r.items;return Object.keys(n).map(function(r){var a=n[r].price.toLocaleString(t.props.currency,{minimumFractionDigits:0});return c.a.createElement("section",{className:"cb_clear",key:r,onClick:function(){t._selectAction(r,e)}},c.a.createElement("div",{className:"items__wrapper"},c.a.createElement("small",null,n[r].category),c.a.createElement("div",{className:"name"},c.a.createElement("h2",null,n[r].name)),c.a.createElement("span",null,a,"\uc6d0"),c.a.createElement("i",null,n[r].isSelected&&c.a.createElement(E.a,{icon:_.a}))))})}return;case"discount":if(Object.keys(r).length){var a=r.discounts;return Object.keys(a).map(function(r){var n=Number(100*a[r].rate).toFixed();return c.a.createElement("section",{className:"cb_clear",key:r,onClick:function(){t._selectAction(r,e)}},c.a.createElement("div",{className:"items__wrapper"},c.a.createElement("div",{className:"name"},c.a.createElement("h2",null,a[r].name)),c.a.createElement("span",{className:"discountPercent"},n,"% \ud560\uc778"),c.a.createElement("i",null,a[r].isSelected&&c.a.createElement(E.a,{icon:_.a}))))})}return;default:return c.a.createElement("section",{className:"noItems cursor-none"},"\uc81c\ud488\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")}}},{key:"render",value:function(){return this.props.error?c.a.createElement("main",null,c.a.createElement("section",{className:"noItems"},"\ub124\ud2b8\uc6cc\ud06c \uc624\ub958\uc785\ub2c8\ub2e4.",c.a.createElement("br",null),c.a.createElement("br",null),"\uc7a0\uc2dc\ud6c4\uc5d0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694. ",this.props.error.message)):this.props.loading?c.a.createElement("main",null,c.a.createElement("section",{className:"noItems"},"Loading ",c.a.createElement(E.a,{icon:_.c,spin:!0}))):c.a.createElement("main",null,this._renderProducts(this.props.headerType))}}]),t}(n.Component)),T=Object(p.b)(function(e){var t={};for(var r in e.interfaceReducer)e.interfaceReducer.hasOwnProperty(r)&&(t[r]=e.interfaceReducer[r]);return t},function(e){return{_handleFetchProducts:function(){e(function(e){return e(m()),fetch("/products").then(f).then(function(e){return e.json()}).then(function(t){e(y(t))}).catch(function(t){return e(h(t))})})},_handleSelectAction:function(t,r){e(function(e,t){return{type:"SELECT_ACTION",key:e,actionType:t}}(t,r))},_handleModifyCount:function(t,r){e(function(e,t){return{type:"MODIFY_COUNT",key:e,val:t}}(t,r))},_handleRemoveSelectedSurgery:function(t){e(function(e){return{type:"REMOVE_SELECTED_SURGERY",key:e}}(t))},_handleApplyDiscount:function(t,r){e(function(e,t){return{type:"APPLY_DISCOUNT",index:e,targetName:t}}(t,r))},_handleDeleteSelectedDiscount:function(t){e(function(e){return{type:"DELETE_SELECTED_DISCOUNT",index:e}}(t))}}})(k),C=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e)))._completeSelected=function(e){r.props._handleCompleteSelected(e)},r._purchse=function(){r.props._handlePurchase()},r}return Object(d.a)(t,e),Object(o.a)(t,[{key:"_renderFooterType",value:function(e){switch(e){case"main":var t=this.props.totalPrice.toLocaleString(this.props.currency,{minimumFractionDigits:0});return c.a.createElement("div",{className:"footer__wrapper"},c.a.createElement("div",{className:"total cb_clear"},c.a.createElement("span",{className:"total__text"},"\ud569\uacc4"),c.a.createElement("strong",{className:"total__price"},t,"\uc6d0")),c.a.createElement("div",null,c.a.createElement(S,{type:"next",text:"\uacb0\uc81c",click:this._purchse,totalPrice:this.props.totalPrice})));case"surgery":case"discount":return c.a.createElement("div",{className:"footer__wrapper select"},c.a.createElement("p",null,"surgery"===e?"\uc81c\ud488\uc744 2\uac1c \uc774\uc0c1 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.":"\ud560\uc778\uc744 \uc120\ud0dd\ud558\uc138\uc694."),c.a.createElement("div",null,c.a.createElement(S,{type:"next complete",text:"\uc644\ub8cc",totalSelected:"surgery"===e?this.props.totalSelectedSurgery:void 0,click:this._completeSelected,headerType:e})));default:return c.a.createElement("div",{className:"footer__wrapper"},c.a.createElement("div",{className:"total cb_clear"},c.a.createElement("span",{className:"total__text"},"\ud569\uacc4"),c.a.createElement("strong",{className:"total__price"},this.props.totalPrice,"\uc6d0")),c.a.createElement("div",null,c.a.createElement(S,{type:"next",text:"\uacb0\uc81c",click:this._purchse,totalPrice:this.props.totalPrice})))}}},{key:"render",value:function(){return c.a.createElement("footer",null,this._renderFooterType(this.props.headerType))}}]),t}(n.Component),D=Object(p.b)(function(e){var t={};for(var r in e.interfaceReducer)e.interfaceReducer.hasOwnProperty(r)&&(t[r]=e.interfaceReducer[r]);return t},function(e){return{_handleCompleteSelected:function(t){e(function(e){return{type:"COMPLETE_SELECTED",headerType:e}}(t))},_handlePurchase:function(){e({type:"PURCHASE"})}}})(C),P=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.props.isPurchasing?c.a.createElement(n.Fragment,null,c.a.createElement("div",{className:"purchase__process"},c.a.createElement(E.a,{icon:_.c,color:"#333",spin:!0,size:"3x"}),c.a.createElement("p",null,"\uacb0\uc81c \uc9c4\ud589\uc911\uc785\ub2c8\ub2e4..."))):c.a.createElement(n.Fragment,null,c.a.createElement(O,null),c.a.createElement(T,null),c.a.createElement(D,null))}}]),t}(n.Component),j=Object(p.b)(function(e){var t={};for(var r in e.interfaceReducer)e.interfaceReducer.hasOwnProperty(r)&&(t[r]=e.interfaceReducer[r]);return t},null)(P),R=r(11),w=r(13),x={currency:"ko-KR",products:{},loading:!1,error:null,userName:"\ucd5c\uc900\uc6d0",totalPrice:0,headerType:"main",totalSelectedSurgery:0,totalSelectedDiscount:0,selectedSurgery:[],selectedDiscount:[],isPurchasing:!1},I=function(e){return void 0!==e&&null!==e?JSON.parse(JSON.stringify(e)):null},L=function(e){var t=0;return e.map(function(e){e.discountPrice?t+=Number(e.discountPrice)*Number(e.count):t+=Number(e.price)*Number(e.count)}),t},U=Object(R.c)({interfaceReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HEADER_TYPE":return Object(w.a)({},e,{headerType:t.headerType});case"SELECT_ACTION":var r=I(e);if("surgery"===t.actionType){r.products.items[t.key].isSelected=!r.products.items[t.key].isSelected;var n=Object.keys(r.products.items).filter(function(e){return r.products.items[e].isSelected});n.length?r.totalSelectedSurgery=n.length:r.totalSelectedSurgery=0}else if("discount"===t.actionType){r.products.discounts[t.key].isSelected=!r.products.discounts[t.key].isSelected;var c=Object.keys(r.products.discounts).filter(function(e){return r.products.discounts[e].isSelected});c.length?r.totalSelectedDiscount=c.length:r.totalSelectedDiscount=0}return r;case"COMPLETE_SELECTED":var a=I(e);if("surgery"===t.headerType){a.totalPrice=0;var s=Object.keys(a.products.items).reduce(function(e,t){return a.products.items[t].isSelected&&(e.push(a.products.items[t]),a.totalPrice=Number(a.totalPrice)+Number(a.products.items[t].price),a.products.items[t].isSelected=!1),a.selectedDiscount.length&&(a.selectedDiscount=[]),e},[]);s.length&&(a.selectedSurgery=s)}else if("discount"===t.headerType){var i=Object.keys(a.products.discounts).reduce(function(e,t){return a.products.discounts[t].isSelected&&(e.push(a.products.discounts[t]),a.products.discounts[t].isSelected=!1),e},[]);i.length&&(a.selectedDiscount=i)}return a.headerType="main",a;case"MODIFY_COUNT":var o=I(e);return o.selectedSurgery[t.key].count=Number(t.val),o.totalPrice=L(o.selectedSurgery),o;case"REMOVE_SELECTED_SURGERY":var l=I(e);return l.selectedDiscount.map(function(e){e.target===l.selectedSurgery[t.key].name&&(e.target=void 0)}),l.selectedSurgery.splice(t.key,1),l.totalPrice=L(l.selectedSurgery),l;case"APPLY_DISCOUNT":var u=I(e),d=Number(u.selectedDiscount[t.index].rate);return u.selectedSurgery.filter(function(e){if(e.name===t.targetName){var r=Number(e.price)*Number(e.count);e.discountPrice=r-r*d,e.discountName=u.selectedDiscount[t.index].name,u.selectedDiscount[t.index].target=e.name}}),u.totalPrice=L(u.selectedSurgery),u;case"DELETE_SELECTED_DISCOUNT":var p=I(e);return p.selectedSurgery.map(function(e){e.discountName===p.selectedDiscount[t.index].name&&(e.discountName=void 0,e.discountPrice=void 0)}),p.selectedDiscount.splice(t.index,1),p.totalPrice=L(p.selectedSurgery),p;case"PURCHASE":return Object(w.a)({},e,{isPurchasing:!0});case"FETCH_PRODUCTS_START":return Object(w.a)({},e,{loading:!0,error:null});case"FETCH_PRODUCTS_SUCCESS":var m=t.payload.products.items,y=t.payload.products.discounts,h=e.currency;return"KRW"===t.payload.products.currency_code?h="ko-KR":"USD"===t.payload.products.currency_code&&(h="en-US"),Object.keys(m).length&&Object.keys(m).map(function(e){return 0===m[e].price?delete m[e]:(m[e].isSelected=!1,m[e].isDiscount=!1,m[e].totalCount=10,-1!==m[e].name.indexOf("\ucef7")?m[e].category="\ucee4\ud2b8":-1!==m[e].name.indexOf("\ub4dc\ub77c\uc774")?m[e].category="\ub4dc\ub77c\uc774":-1!==m[e].name.indexOf("\ud38c")?m[e].category="\ud38c":m[e].category="\uae30\ud0c0",m)}),Object.keys(y).length&&Object.keys(y).map(function(e){return y[e].isSelected=!1,y}),Object(w.a)({},e,{currency:h,loading:!1,products:t.payload.products});case"FETCH_PRODUCTS_FAILURE":return Object(w.a)({},e,{loading:!1,error:String(t.payload.error),products:[]});default:return e}}}),F=r(23);s.a.render(c.a.createElement(p.a,{store:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];if(window.location&&window.location.host&&-1!==window.location.host.indexOf("localhost")){var n=r(39).logger;t.push(n)}return Object(R.d)(U,e,R.a.apply(void 0,[F.a].concat(t)))}()},c.a.createElement(j,null)),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.cb64c129.chunk.js.map